<html>

<%- include('./partials/head.ejs')  %>

<body>
    <div class='container-fluid'>
        <div class='row'>
            <%- include('./partials/sidebar.ejs') %>
            <div class='col-sm-10'>
                <% console.log(typeof(errors)) %>
                <h1><%= title %> </h1>
                <form method='POST' action=''>
                    <div class="form-group">
                        <label for="title">Title:</label>
                        <input type="text" placeholder='Name of book' name="title" id="title" class="form-control"
                            value="<%= ('undefined'===typeof(book) ? '' : book.title) %>" required='true'>
                    </div>
                    <div class='form-group'>
                        <label for='author'>Author:</label>
                        <% let snorks=['The', 'end', 'of', 'the', 'world', 'as', 'we', 'know', 'it!'] %>
                        <select class='form-control' name="author" id="author" required='true'
                            placeholder="Select author">
                            <% authors.sort(function(a, b) {let textA = a.family_name.toUpperCase(); let textB = b.family_name.toUpperCase(); return (textA < textB) ? -1 : (textA > textB) ? 1 : 0;}); %>
                            <% authors.forEach(author => { %>
                            <% if (typeof(book) != 'undefined') { %>
                            <option value='<%= author._id %>'
                                selected="<%= (author._id.toString()==book.author ? 'selected' : false) %>">
                                <%= author.name %> </option>
                            <% } else { %>
                            <option value='<%= author._id %>'><%= author.name %> </option>
                            <% } %>
                            <% }) %>

                        </select>
                    </div>

                    <button type="submit" class="btn btn-primary">Submit</button>
                </form>
            </div>
        </div>
    </div>
</body>

</html>